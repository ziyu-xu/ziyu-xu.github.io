---
title: 使用Origin和Adobe Illustrator建立交联质谱图
date: 2024-09-25 14:27:49
tags: Tutorials
---

# 目标

使用Origin和Adobe Illustrator将原始的交联质谱数据转化为圆环形交联质谱图

<!--more-->

# 步骤

## Excel处理数据

为了方便在Origin中完成画图，我们需要将未经处理的质谱数据转化为两行-一交联对的格式。具体操作如下：

### 1. 利用分列转化为单行数据

原始数据格式一般如下图所示。使用**数据-分列**，将括号等符号设为分列符，得到如下效果的一行-一交联的数据。

<figure>
    <img src="image-20240925144910256.png" alt="处理前后效果变化" width="60%"/> 
    <figcaption>处理前后效果变化</figcaption>
</figure>

### 2. 利用插入行转化为双行数据

接下来使用插入行功能，将一行-一交联的数据转化为两行-一交联的数据。

首先如下图红色字样输入1,2交替的**两个辅助列** (1)。

之后选中下图中框选区域部分**开始-查找与选择-定位条件-空值**，选中单元格后插入工作表行，得到隔行插入空行的数据(2)。

之后向下移动后半部分数据一行(3)。

之后选中下图(3)中选中部分，**开始-查找与选择-定位条件-空值**，选中单元格后删除-右方单元格左移，得到最终数据(4)。

<figure>
    <img src="image-20240925153359055.png" alt="利用插入行转化为双行数据" width="70%"/> 
    <figcaption>利用插入行转化为双行数据</figcaption>
</figure>

### 3. 将双行数据转化为极坐标数据

为了在Origin中得到圆环状交联色谱图，我们采用极坐标方式作图。这样我们需要将蛋白位点转化为极坐标的角度，每个位点需要有对应的角度数值。

我们首先对每个蛋白进行编号。我们从0°开始，蛋白A,B,C顺序逆时针排列，那么蛋白B和C的残基编号需要在前面的基础上加一个值。假设A蛋白有150，B有600，C有900残基，蛋白之间的空白部分占80残基的体积。那么我们得到下图中左下角的表格信息。通过求和，我们能得到各个蛋白和空白需要增加的数值量。

之后在左上角的双行数据中，选中对应蛋白编号(A,B,C)的列，并查找替换为需要增加的数值量(左上角第三列)，并通过求和得到最终编号(红字)。

极坐标角度由 [(最终编号*360)/(左下角total)] 的公式求得；轴长r统一设置为1. 这样我们得到了需要在Origin中画图的极坐标数据(黑框中的数据)。

<figure>
    <img src="image-20240925162225238.png" alt="将双行数据转化为极坐标数据" width="70%"/> 
    <figcaption>将双行数据转化为极坐标数据</figcaption>
</figure>

## Origin处理数据

我们将上述极坐标数据复制粘贴到Origin中。选择下方极坐标格式开始作图，得到的是右下角的图像。

<figure>
    <img src="image-20240925163601298.png" alt="Origin创建极坐标图" width="70%"/> 
    <figcaption>Origin创建极坐标图</figcaption>
</figure>

这个图像需要经过一些处理得到交联质谱图。1) 删除所有刻度线和坐标，只留下最外面的圆圈；2) 选择Plot details - Plot properties, Line-Connect 为2 Point Segment，这样使得只有每两个数据点之间进行连线，符合交联质谱对的双行数据。3) 改线条的长度颜色等。最后将图片导出。

P.S. 如果需要高亮某一些交联对或者做区分颜色的交联对，可以先分别作图，统一主题格式之后，采用Graph-Merge graph window对两张图片进行merge，merge之后再保存即可。

<figure>
    <img src="image-20240925164612201.png" alt="Origin创建交联质谱图" width="70%"/> 
    <figcaption>Origin创建交联质谱图</figcaption>
</figure>

## AI作外围蛋白卡通图

打开AI，首先用AI制造出一圆环，再画一个更大的圆，二者中心对齐，将大圆转为扇形。按照上一步Excel中计算好的开始-结束的角度，每一个蛋白就复制一个扇形，并且对准其所占据的角度，如下图所示，三个扇形分别代表A(150氨基酸)；B(600氨基酸)和C(900氨基酸)。

选中圆环和所有扇形，点击**路径查找器-分割**，把圆环分割成小块，如下图右边所示。小块可以分别染色或者做风格处理。

<figure>
    <img src="image-20240925170632898.png" alt="AI描绘交联质谱图" width="70%"/> 
    <figcaption>AI描绘交联质谱图</figcaption>
</figure>

将Origin生成的交联质谱连线粘贴进AI或PPT，最终效果如下：

<figure>
    <img src="image-20240925171739938.png" alt="最终效果图" width="45%"/> 
    <figcaption>最终效果图</figcaption>
</figure>

